[PARSER]
    Name   apache
    Format regex
    Regex  ^(?<host>[^ ]*) [^ ]* (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)?" (?<code>[^ ]*) (?<size>[^ ]*)(?: "(?<referer>[^\"]*)" "(?<agent>[^\"]*)")?$
    Time_Key time
    Time_Format %d/%b/%Y:%H:%M:%S %z

[PARSER]
    Name   apache2
    Format regex
    Regex  ^(?<host>[^ ]*) [^ ]* (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^ ]*) +\S*)?" (?<code>[^ ]*) (?<size>[^ ]*)(?: "(?<referer>[^\"]*)" "(?<agent>.*)")?$
    Time_Key time
    Time_Format %d/%b/%Y:%H:%M:%S %z

[PARSER]
    Name   apache_error
    Format regex
    Regex  ^\[[^ ]* (?<time>[^\]]*)\] \[(?<level>[^\]]*)\](?: \[pid (?<pid>[^\]]*)\])?( \[client (?<client>[^\]]*)\])? (?<message>.*)$

[PARSER]
    Name   nginx
    Format regex
    Regex ^(?<remote>[^ ]*) (?<host>[^ ]*) (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)?" (?<code>[^ ]*) (?<size>[^ ]*)(?: "(?<referer>[^\"]*)" "(?<agent>[^\"]*)")
    Time_Key time
    Time_Format %d/%b/%Y:%H:%M:%S %z

[PARSER]
    # https://rubular.com/r/IhIbCAIs7ImOkc
    Name        k8s-nginx-ingress
    Format      regex
    Regex       ^(?<host>[^ ]*) - (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)?" (?<code>[^ ]*) (?<size>[^ ]*) "(?<referer>[^\"]*)" "(?<agent>[^\"]*)" (?<request_length>[^ ]*) (?<request_time>[^ ]*) \[(?<proxy_upstream_name>[^ ]*)\] (\[(?<proxy_alternative_upstream_name>[^ ]*)\] )?(?<upstream_addr>[^ ]*) (?<upstream_response_length>[^ ]*) (?<upstream_response_time>[^ ]*) (?<upstream_status>[^ ]*) (?<reg_id>[^ ]*).*$
    Time_Key    time
    Time_Format %d/%b/%Y:%H:%M:%S %z

[PARSER]
    Name   json
    Format json
    Time_Key time
    Time_Format %d/%b/%Y:%H:%M:%S %z

[PARSER]
    Name         docker
    Format       json
    Time_Key     time
    Time_Format  %Y-%m-%dT%H:%M:%S.%L
    Time_Keep    On
    # --
    # Since Fluent Bit v1.2, if you are parsing Docker logs and using
    # the Kubernetes filter, it's not longer required to decode the
    # 'log' key.
    #
    # Command      |  Decoder | Field | Optional Action
    # =============|==================|=================
    #Decode_Field_As    json     log

[PARSER]
    Name        syslog-rfc5424
    Format      regex
    Regex       ^\<(?<pri>[0-9]{1,5})\>1 (?<time>[^ ]+) (?<Hostname>[^ ]+) (?<ident>[^ ]+) (?<pid>[-0-9]+) (?<msgid>[^ ]+) (?<extradata>(\[(.*?)\]|-)) (?<message>.+)$
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On

[PARSER]
    Name        syslog-rfc3164-local
    Format      regex
    Regex       ^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S
    Time_Keep   On

[PARSER]
    Name        syslog-arista
    Format      regex
    Regex       /^(?:[^a-zA-Z]*)(?<Time>[^ ]* {1,2}[^ ]* [^ ]*) (?<Hostname>[^ ]*) (?<Log>.*)$/
    Time_Key    time
    Time_Format %d %b %H:%M:%S
    Time_Keep   On

[PARSER]
    Name        syslog-arista-1
    Format      regex
    Regex       /^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<log>.*)$/
    Time_Key    time
    Time_Format %d %b %H:%M:%S
    Time_Keep   On

[PARSER]
    #Name        syslog-rfc3164
    Name        syslog-arista-2
    Format      regex
    Regex       /^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<log>.*)$/
#    Time_Key    time
#    Time_Format %b %d %H:%M:%S
    Time_Key    Time
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On

[PARSER]
    Name        syslog-palo
    Format      regex
    Regex       ^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<log>.+)
[PARSER]
    Name        syslog-palo-traffic
    Format      regex
    Regex       ^(?<domain>[^,]+)\,(?<receive_time>[^,]+)\,(?<serial>[^,]+)\,(?<type>[^,]*)\,(?<threat_content_type>[^,]*)\,(?<config_version>[^,]*)\,(?<generate_time>[^,]*)\,(?<source_address>[^,]*)\,(?<destination_address>[^,]*)\,(?<nat_source_ip>[^,]*)\,(?<nat_destination_ip>[^,]*)\,(?<rule>[^,]*)\,(?<source_user>[^,]*)\,(?<destination_user>[^,]*)\,(?<application>[^,]*)\,(?<virtual_system>[^,]*)\,(?<source_zone>[^,]*)\,(?<destination_zone>[^,]*)\,(?<inbound_interface>[^,]*)\,(?<outbound_interface>[^,]*)\,(?<log_action>[^,]*)\,(?<time_logged>[^,]*)\,(?<session_id>[^,]*)\,(?<repeat_count>[^,]*)\,(?<source_port>[^,]*)\,(?<destination_port>[^,]*)\,(?<nat_source_port>[^,]*)\,(?<nat_destination_port>[^,]*)\,(?<flags>[^,]*)\,(?<ip_protocol>[^,]*)\,(?<action>[^,]*)\,(?<bytes>[^,]*)\,(?<bytes_sent>[^,]*)\,(?<bytes_received>[^,]*)\,(?<packets>[^,]*)\,(?<start_time>[^,]*)\,(?<elapsed_time>[^,]*)\,(?<category>[^,]*)\,(?<tpadding>[^,]*)\,(?<sequence_number>[^,]*)\,(?<action_flags>[^,]*)\,(?<source_country>[^,]*)\,(?<destination_country>[^,]*)\,(?<cpadding>[^,]*)\,(?<packets_sent>[^,]*)\,(?<packets_received>[^,]*)\,(?<session_end_reason>[^,]*)\,(?<dg_hierarchy_level_1>[^,]*)\,(?<dg_hierarchy_level_2>[^,]*)\,(?<dg_hierarchy_level_3>[^,]*)\,(?<dg_hierarchy_level_4>[^,]*)\,(?<virtual_system_name>[^,]*)\,(?<device_name>[^,]*)\,(?<action_source>[^,]*)\,(?<source_vm_uuid>[^,]*)\,(?<destination_vm_uuid>[^,]*)\,(?<tunnel_id_imsi>[^,]*)\,(?<monitor_tag_imei>[^,]*)\,(?<parent_session_id>[^,]*)\,(?<parent_session_start_time>[^,]*)\,(?<tunnel>[^,]*)\,(?<sctp_association_id>[^,]*)\,(?<sctp_chunks>[^,]*)\,(?<sctp_chunks_sent>[^,]*)\,(?<sctp_chunks_received>[^,]*)\,(?<uuid_for_rule>[^,]*)\,(?<http_2_connection>[^,]*)\,(?<link_change_count>[^,]*)\,(?<policy_id>[^,]*)\,(?<link_switches>[^,]*)\,(?<sd_wan_cluster>[^,]*)\,(?<sd_wan_device_type>[^,]*)\,(?<sdwan_cluster_type>[^,]*)\,(?<sdwan_site>[^,]*)\,(?<dynusergroup_name>[^,]*)\,(?<xff_address>[^,]*)\,(?<source_device_category>[^,]*)\,(?<source_device_profile>[^,]*)\,(?<source_device_model>[^,]*)\,(?<source_device_vendor>[^,]*)\,(?<source_device_os_family>[^,]*)\,(?<source_device_os_version>[^,]*)\,(?<source_hostname>[^,]*)\,(?<source_mac_address>[^,]*)\,(?<destination_device_category>[^,]*)\,(?<destination_device_profile>[^,]*)\,(?<destination_device_model>[^,]*)\,(?<destination_device_vendor>[^,]*)\,(?<destination_device_os_family>[^,]*)\,(?<destination_device_os_version>[^,]*)\,(?<destinantion_device_hostname>[^,]*)\,(?<destinantion_device_mac_address>[^,]*)\,(?<container_id>[^,]*)\,(?<pod_namespace>[^,]*)\,(?<pod_name>[^,]*)\,(?<source_external_dynamic_list>[^,]*)\,(?<destinantion_external_dynamic_list>[^,]*)\,(?<host_id>[^,]*)\,(?<serial_number>[^,]*)\,(?<source_dynamic_address_group>[^,]*)\,(?<destination_dynamic_address_group>[^,]*)\,(?<session_owner>[^,]*)\,(?<high_res_timestamp>[^,]*)\,(?<nssai_sst>[^,]*)\,(?<nssai_sd>[^,]*)
    #Regex       ^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?P<Timestamp>\w+\s+\d+\s+\d+:\d+:\d+)\s+(?P<Hostname>\S+)\s+:\s+(?P<LogType>\S+)\s+:\s+(?P<EventID>\d+)\s+:\s+(?P<LogMessage>.+)$
    Time_Key    Time
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On

[PARSER]
    Name    mongodb
    Format  regex
    Regex   ^(?<time>[^ ]*)\s+(?<severity>\w)\s+(?<component>[^ ]+)\s+\[(?<context>[^\]]+)]\s+(?<message>.*?) *(?<ms>(\d+))?(:?ms)?$
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On
    Time_Key time

[PARSER]
    # https://rubular.com/r/0VZmcYcLWMGAp1
    Name    envoy
    Format  regex
    Regex ^\[(?<start_time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)? (?<protocol>\S+)" (?<code>[^ ]*) (?<response_flags>[^ ]*) (?<bytes_received>[^ ]*) (?<bytes_sent>[^ ]*) (?<duration>[^ ]*) (?<x_envoy_upstream_service_time>[^ ]*) "(?<x_forwarded_for>[^ ]*)" "(?<user_agent>[^\"]*)" "(?<request_id>[^\"]*)" "(?<authority>[^ ]*)" "(?<upstream_host>[^ ]*)"
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On
    Time_Key start_time

[PARSER]
    # https://rubular.com/r/17KGEdDClwiuDG
    Name    istio-envoy-proxy
    Format  regex
    Regex ^\[(?<start_time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)? (?<protocol>\S+)" (?<response_code>[^ ]*) (?<response_flags>[^ ]*) (?<response_code_details>[^ ]*) (?<connection_termination_details>[^ ]*) (?<upstream_transport_failure_reason>[^ ]*) (?<bytes_received>[^ ]*) (?<bytes_sent>[^ ]*) (?<duration>[^ ]*) (?<x_envoy_upstream_service_time>[^ ]*) "(?<x_forwarded_for>[^ ]*)" "(?<user_agent>[^\"]*)" "(?<x_request_id>[^\"]*)" (?<authority>[^ ]*)" "(?<upstream_host>[^ ]*)" (?<upstream_cluster>[^ ]*) (?<upstream_local_address>[^ ]*) (?<downstream_local_address>[^ ]*) (?<downstream_remote_address>[^ ]*) (?<requested_server_name>[^ ]*) (?<route_name>[^  ]*)
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On
    Time_Key start_time

[PARSER]
    # http://rubular.com/r/tjUt3Awgg4
    Name cri
    Format regex
    Regex ^(?<time>[^ ]+) (?<stream>stdout|stderr) (?<logtag>[^ ]*) (?<message>.*)$
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On

[PARSER]
    Name    kube-custom
    Format  regex
    Regex   (?<tag>[^.]+)?\.?(?<pod_name>[a-z0-9](?:[-a-z0-9]*[a-z0-9])?(?:\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*)_(?<namespace_name>[^_]+)_(?<container_name>.+)-(?<docker_id>[a-z0-9]{64})\.log$

